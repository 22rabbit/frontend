(this.webpackJsonpdragraph=this.webpackJsonpdragraph||[]).push([[0],{136:function(e,t,a){e.exports=a.p+"static/media/favicon.6e1267d9.ico"},159:function(e,t,a){e.exports=a(304)},303:function(e,t,a){},304:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(26),o=a.n(c),l=a(78),i=a(47),s=a(48),d=a(52),m=a(51),u=a(307),p=a(106),h=a(308),f=a(315),g=a(316),b=a(136),k=a.n(b),y=a(137),v=a.n(y),E=u.a.Header,O=u.a.Content,j=u.a.Sider,D=p.a.SubMenu,I=function(e){Object(d.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,c=new Array(n),o=0;o<n;o++)c[o]=arguments[o];return(e=t.call.apply(t,[this].concat(c))).drawMenus=function(t){return t.map((function(t){return void 0===t.children?r.a.createElement(p.a.Item,{key:Object(g.a)(),onClick:function(){"function"===typeof t.onclick&&t.onclick(t,e.props.graph)}},t.name):r.a.createElement(D,{title:t.name,key:Object(g.a)()},e.drawMenus(t.children))}))},e.handleSave=function(t){var a=e.props.data.graph.save();console.log(a),v.a.post("/edit",{uuid:"\u4ea7\u54c1id",data:a}).then((function(e){console.log(e)}))},e}return Object(s.a)(a,[{key:"render",value:function(){var e=this;return console.log(this.props),r.a.createElement(u.a,{style:{height:"100%"}},r.a.createElement(E,{className:"header"},r.a.createElement(h.a,null,r.a.createElement("div",{className:"logo"},r.a.createElement("img",{src:k.a})),r.a.createElement(p.a,{theme:"dark",mode:"horizontal",defaultSelectedKeys:["2"],selectedKeys:[""]},r.a.createElement(p.a.Item,{key:"2",onClick:this.props.changeMode},this.props.data.beginLink?r.a.createElement("div",null,"\u52a0\u70b9\u6a21\u5f0f"):r.a.createElement("div",null,"\u8fde\u7ebf\u6a21\u5f0f")),r.a.createElement(p.a.Item,{key:"save",onClick:this.handleSave},"\u4fdd\u5b58\u6a21\u578b"),r.a.createElement(p.a.Item,null,r.a.createElement("span",{"data-command":"undo"}," \u64a4\u9500"))))),r.a.createElement(u.a,null,r.a.createElement(j,{width:220,className:"site-layout-background",theme:"light",style:{overflow:"hidden"}},r.a.createElement("div",{style:{overflow:"scroll",height:"102.5%",width:240}},r.a.createElement(p.a,{mode:"inline",selectable:!1,defaultOpenKeys:["sub1"],style:{height:"100%",borderRight:0}},r.a.createElement(D,{key:"sub1",icon:r.a.createElement(f.a,null),title:"subnav 1"},r.a.createElement(p.a.Item,{key:"1",onClick:function(){var t={id:Object(g.a)(),label:"node",address:"cq",x:200,y:150,style:{fill:"blue"}};e.props.graph.addItem("node",t)}},"option1"),r.a.createElement(p.a.Item,{key:"2",onClick:function(){}},"option2"),r.a.createElement(p.a.Item,{key:"3",data:"abc",onClick:function(e){console.log(e,e.key)}},"option3"),r.a.createElement(p.a.Item,{key:"4"},"option4")),this.drawMenus(this.props.data.toolData)))),r.a.createElement(u.a,null,r.a.createElement(O,{className:"site-layout-background",style:{padding:24,margin:0,minHeight:280},ref:this.props.graphConRef},this.props.children),r.a.createElement(j,{width:200,className:"site-layout-background",theme:"light"},r.a.createElement(z,this.props)))))}}]),a}(n.Component),M=function(e){Object(d.a)(a,e);var t=Object(m.a)(a);function a(){var e;return Object(i.a)(this,a),(e=t.call(this)).state={},e}return Object(s.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{ref:this.props.dom,style:{width:"100%",height:"100%"}})}}]),a}(n.Component),S=a(313),w=a(314),R=a(317),C=a(312),x=a(310),B=a(68),N=a(311),z=function(e){Object(d.a)(a,e);var t=Object(m.a)(a);function a(){var e;return Object(i.a)(this,a),(e=t.call(this)).makeDetails=function(t){t.keyData||(t.keyData={});var a=t.keyData;return e.props.data.params[t.data.name]?e.props.data.params[t.data.name].map((function(e){var t="",n="";switch(e.type){case"text":t=r.a.createElement(S.a,{key:Object(g.a)()}),n=e.default||"";break;case"radio":t=r.a.createElement(w.a.Group,{key:Object(g.a)()},e.datas.map((function(e){return r.a.createElement(w.a,{value:e.val,key:Object(g.a)()},e.name)}))),n=e.default||"";break;case"number":t=r.a.createElement(R.a,Object.assign({key:Object(g.a)()},e.datas)),n=e.default||e.datas.min;break;case"select":t=r.a.createElement(C.a,null,e.datas.map((function(e){return r.a.createElement(C.a.Option,{value:e.val,key:Object(g.a)()},e.name)}))),n=e.default||""}return console.log(a),void 0!==a[e.name]?n=a[e.name]:a[e.name]=n,console.log(n),r.a.createElement(x.a.Item,{label:e.name,key:Object(g.a)(),name:e.name,initialValue:n,help:e.tip},t)})):r.a.createElement(B.a,{description:r.a.createElement("span",null,"\u6ca1\u6709\u53ef\u8c03\u53c2\u6570")})},e.componentDidMount=function(){console.log(123),e.formRef.current&&(console.log(e.formRef.current),e.formRef.current.resetFields())},e.componentDidUpdate=function(){e.formRef.current&&(console.log(e.formRef.current),e.formRef.current.resetFields())},e.formRef=r.a.createRef(),e.ok=!1,e}return Object(s.a)(a,[{key:"render",value:function(){if(!this.props.data.graph)return r.a.createElement("div",null);console.log(this.props);var e=this.props.data.graph.findById(this.props.data.currentID);if(!e)return r.a.createElement("div",null);var t=e._cfg.model;return console.log(t),this.ok=!0,r.a.createElement("div",null,r.a.createElement(N.a,{className:"\u7ec4\u4ef6\u8be6\u60c5",title:t.data.name}),r.a.createElement(x.a,{layout:"vertical",key:Object(g.a)(),ref:this.formRef,onFieldsChange:function(e,a){console.log(e,a),e.map((function(e){var a=e.name[0],n=e.value;t.keyData[a]=n,console.log(t)}))}},this.makeDetails(t)))}}]),a}(n.Component),H=a(94),L=a.n(H),F=a(309),G=a(105),K=function(e,t){var a={id:Object(g.a)(),label:e.name,size:e.size||50,type:e.type||"circle",x:200,y:150,style:e.style,data:e};t.addItem("node",a)},T=function(e){Object(d.a)(a,e);var t=Object(m.a)(a);function a(){var e,r;return Object(i.a)(this,a),(r=t.call(this)).changeMode=function(){r.setState({beginLink:!r.state.beginLink})},r.drawGraph=function(){var e=new L.a.ToolBar({container:r.toolBarRef.current});r.toolbar=e;new L.a.Minimap;r.setState({graph:new L.a.Graph({plugins:[e],container:o.a.findDOMNode(r.graphDOM.current),width:r.graphDOM.current.offsetWidth,height:r.graphDOM.current.offsetHeight,modes:{default:["drag-canvas","zoom-canvas","drag-node"]},nodeStateStyles:{click:{fill:"#d3adf7","node-label":{fontSize:15}}},enabledStack:!0}),loading:!1},(function(){r.state.graph.on("node:click",(function(e){r.lastid=r.state.currentID,console.log(r.lastid);var t=r.state.graph;t.findAllByState("node","click").forEach((function(e){t.setItemState(e,"click",!1)}));var a=e.item;t.setItemState(a,"click",!0),console.log(a),r.setState({currentID:a._cfg.id},(function(){console.log(r.lastid,r.state.currentID),r.lastid&&r.state.currentID&&r.state.beginLink&&(t.addItem("edge",{id:Object(g.a)(),source:r.lastid,target:r.state.currentID,style:{endArrow:!0}}),r.lastid="",t.setItemState(a,"click",!1),r.setState({currentID:""}))}))}))}))},r.state=(e={beginLink:!1,graph:"",currentID:""},Object(l.a)(e,"beginLink",!1),Object(l.a)(e,"params",{"\u6bd4\u4f8b\u7f29\u653e":[{name:"\u6bd4\u4f8b\u7cfb\u6570",type:"number",default:.7,datas:{step:.1,min:0,max:2}}],"DHT11\u6e29\u6e7f\u5ea6\u4f20\u611f\u5668":[{name:"\u6570\u636e\u7c7b\u578b",type:"radio",datas:[{name:"\u6e29\u5ea6",val:"tmp"},{name:"\u6e7f\u5ea6",val:"humi"}]},{name:"\u6570\u636e\u7cbe\u5ea6",type:"select",datas:[{name:"float",val:"float"},{name:"double",val:"double"}],props:{placeholder:"\u9009\u62e9\u6570\u636e\u7cbe\u5ea6"}}],"\u81ea\u5b9a\u4e49\u5904\u7406\u51fd\u6570":[{name:"\u51fd\u6570\u4f53",type:"text",tip:"\u8f93\u5165\u4ee5x\u4e3a\u81ea\u53d8\u91cf\u7684\u5355\u503c\u663e\u5f0f\u51fd\u6570",default:"x*2"}],"\u900f\u4f20":[{name:"\u670d\u52a1\u5668IP",type:"text",default:"0.0.0.0"},{name:"\u670d\u52a1\u5668\u7aef\u53e3",type:"text"}],"NB-Iot":[{name:"ProductKey",type:"text"},{name:"ProductSecret",type:"text"}]}),Object(l.a)(e,"toolData",[{name:"\u8f93\u5165\u6a21\u5757",children:[{name:"DHT11\u6e29\u6e7f\u5ea6\u4f20\u611f\u5668",onclick:K,type:"rect",size:[120,50],style:{}},{name:"\u7535\u538b\u4f20\u611f\u5668",onclick:K}]},{name:"\u6570\u636e\u5904\u7406",children:[{name:"\u6bd4\u4f8b\u7f29\u653e",onclick:K},{name:"\u4e582",onclick:K},{name:"\u9664\u4e8c",onclick:K},{name:"\u81ea\u5b9a\u4e49\u5904\u7406\u51fd\u6570",onclick:K}]},{name:"\u4e0a\u4f20\u6a21\u5757",img:"img/a.jpg",children:[{name:"\u900f\u4f20",onclick:K},{name:"NB-Iot",onclick:K}]}]),Object(l.a)(e,"loading",!0),e),r.graphDOM=Object(n.createRef)(),r.toolBarRef=Object(n.createRef)(),r.graphConRef=Object(n.createRef)(),r}return Object(s.a)(a,[{key:"componentDidMount",value:function(){var e=this;console.log(this.graphDOM.current.offsetWidth,this.graphDOM.current.offsetHeight),setTimeout((function(){console.log(e.graphDOM.current.offsetWidth,e.graphDOM.current.offsetHeight),e.drawGraph()}),2e3),Object(G.a)("Delete,Backspace",(function(t,a){console.log(a),e.state.graph&&e.state.currentID&&(e.state.graph.removeItem(e.state.currentID),e.setState({currentID:""}))})),Object(G.a)("ctrl+z",(function(){console.log(e.state.graph),console.log(e.state.graph.undoStack.linkedList.compare.compare),e.toolbar.undo()}))}},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(I,{graph:this.state.graph,data:this.state,changeMode:this.changeMode,graphConRef:this.graphConRef},r.a.createElement("div",{ref:this.toolBarRef,style:{position:"relative",display:"flex"}}),this.state.loading?r.a.createElement(F.a,null):r.a.createElement(r.a.Fragment,null),r.a.createElement(M,{data:{nodes:this.state.nodes,edges:this.state.edges},dom:this.graphDOM})))}}]),a}(n.Component);a(302),a(303);Object(c.render)(r.a.createElement(T,null),document.querySelector("#root"))}},[[159,1,2]]]);
//# sourceMappingURL=main.ebbdc9ac.chunk.js.map